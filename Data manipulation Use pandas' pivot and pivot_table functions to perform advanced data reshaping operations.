import pandas as pd
import numpy as np

# Sample data
data = {
    "Date": ["2025-01-01", "2025-01-01", "2025-01-02", "2025-01-02", "2025-01-03", "2025-01-03"],
    "City": ["New York", "London", "New York", "London", "New York", "London"],
    "Temperature": [32, 45, 30, 43, 28, 40],
    "Humidity": [65, 70, 60, 72, 58, 74]
}

df = pd.DataFrame(data)
print("Original DataFrame:\n", df)

# 1. Using pivot: Reshape data so Dates are rows and Cities are columns for Temperature
pivot_df = df.pivot(index="Date", columns="City", values="Temperature")
print("\nPivot Result (Temperature by Date & City):\n", pivot_df)

# 2. Using pivot_table: Calculate average Humidity per Date and City (allows aggregation)
pivot_table_df = df.pivot_table(
    index="Date", 
    columns="City", 
    values="Humidity", 
    aggfunc=np.mean
)
print("\nPivot Table Result (Avg Humidity by Date & City):\n", pivot_table_df)

# 3. Multiple values: Pivot table with Temperature & Humidity and aggregation
multi_pivot_table = df.pivot_table(
    index="Date", 
    columns="City", 
    values=["Temperature", "Humidity"], 
    aggfunc=np.mean
)
print("\nMulti-Value Pivot Table:\n", multi_pivot_table)
